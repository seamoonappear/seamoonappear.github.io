<!-- _includes/comments/providers/cusdis.html -->
<!-- Cusdis 评论系统嵌入代码 - 高度优化且无邮箱选项 -->

<div id="cusdis_thread"
  data-host="{{ site.comments.cusdis.host | default: 'https://cusdis.com' }}"
  data-app-id="{{ site.comments.cusdis.data_app_id }}"
  data-page-id="{{ page.id | default: page.url | absolute_url }}"
  data-page-url="{{ page.url | absolute_url }}"
  data-page-title="{{ page.title }}"
  data-theme="{{ site.comments.cusdis.theme | default: 'auto' }}"
  style="min-height: 300px; width: 100%; margin-top: 1rem;">
</div>

<!-- 异步加载 Cusdis JavaScript 库 -->
<script async defer src="{{ site.comments.cusdis.host | default: 'https://cusdis.com' }}/js/cusdis.es.js"></script>

<!-- 高度优化脚本 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // 等待 Cusdis 加载完成
  setTimeout(function() {
    const cusdisFrame = document.querySelector('#cusdis_thread iframe');
    if (cusdisFrame) {
      // 设置最小高度
      cusdisFrame.style.minHeight = '300px';
      cusdisFrame.style.height = 'auto';
    }
    
    // 调整内部元素
    const cusdisContainer = document.getElementById('cusdis_thread');
    if (cusdisContainer) {
      // 确保容器有合适的最小高度
      cusdisContainer.style.minHeight = '300px';
    }
  }, 1500); // 稍微延长等待时间确保Cusdis完全加载
});

// 监听窗口大小变化
window.addEventListener('resize', function() {
  const cusdisContainer = document.getElementById('cusdis_thread');
  if (cusdisContainer) {
    // 根据屏幕尺寸调整最小高度
    if (window.innerWidth <= 480) {
      cusdisContainer.style.minHeight = '200px';
    } else if (window.innerWidth <= 768) {
      cusdisContainer.style.minHeight = '250px';
    } else {
      cusdisContainer.style.minHeight = '300px';
    }
  }
});
</script>

<!-- 中文本地化配置 - 已移除邮箱相关选项 -->
<script>
window.CUSDIS_LOCALE = {
  powered_by: '评论由 Cusdis 提供',
  post_comment: '发送评论',
  loading: '加载中',
  nickname: '昵称',
  reply_placeholder: '输入回复...',
  comment_placeholder: '留下你的评论……',
  anonymous: '匿名',
  error: {
    comment_is_required: '评论内容不能为空。',
    nickname_is_required: '昵称不能为空。',
    confirmation_is_required: '请确认您是否继续提交评论。'
  },
  comment_has_been_sent: '评论已发送，待审核后显示。'
};
</script>

<!-- 自定义CSS隐藏邮箱输入框 -->
<style>
/* 隐藏Cusdis中的邮箱输入框 */
#cusdis_thread .cusdis-input-email-container {
  display: none !important;
}
</style>