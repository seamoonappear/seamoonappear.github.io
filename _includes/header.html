{% assign date_format = site.date_format | default: "%B %-d, %Y" %}

{% if page.cover-img %}
  <div id="header-big-imgs" data-num-img={% if page.cover-img.first %}{{ page.cover-img.size }}{% else %}1{% endif %}
    {% for bigimg in page.cover-img %}
      {% assign imgnum = forloop.index %}
      {% for imginfo in bigimg %}
        {% if imginfo[0] %}
          data-img-src-{{ imgnum }}="{{ imginfo[0] | absolute_url }}"
          data-img-desc-{{ imgnum }}="{{ imginfo[1] }}"
        {% else %}
          data-img-src-{{ imgnum }}="{{ imginfo | absolute_url }}"
        {% endif %}
      {% endfor %}
    {% endfor %}
  ></div>
{% endif %}

<header class="header-section {% if page.cover-img %}has-img{% endif %}">
  <div class="intro-header {% if page.cover-img %} big-img {% endif %}">
  
    <!-- ✅ 调整这里：在原容器内让导航靠左、标题靠右 -->
    <div class="container-md py-3 d-flex justify-content-between align-items-center">
      <nav class="site-nav">
        <ul class="list-inline m-0">
          {% for link in site.navbar-links %}
            <li class="list-inline-item mx-2"><a href="{{ link[1] | relative_url }}">{{ link[0] }}</a></li>
          {% endfor %}
        </ul>
      </nav>

      <div class="site-title text-end">
        <a href="{{ site.url | default: '/' }}" class="text-decoration-none">
          <h1 class="m-0">{{ site.title }}</h1>
        </a>
      </div>
    </div>

    {% if page.cover-img or page.title %}
    <div class="container-md">
      <div class="row">
        <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
          <div class="{{ include.type }}-heading">
            <h1>{% if page.title %}{{ page.title | strip_html }}{% else %}<br/>{% endif %}</h1>
            {% if page.subtitle %}
              {% if include.type == "page" %}
                <hr class="small">
                <span class="{{ include.type }}-subheading">{{ page.subtitle | strip_html }}</span>
              {% else %}
                <h2 class="{{ include.type }}-subheading">{{ page.subtitle | strip_html }}</h2>
              {% endif %}
            {% endif %}
            
            {% if include.type == "post" %}
              {% if page.author %}
                作者：<strong>{{ page.author | strip_html }}</strong><br>
              {% endif %}
              <span class="post-meta">发表于 {{ page.date | date: "%Y年%-m月%-d日" }}</span>
              {% if page.last-updated %}
                <span class="post-meta">
                  <span class="d-none d-md-inline middot">&middot;</span>
                  更新于 {{ page.last-updated | date: "%Y年%-m月%-d日" }}
                </span>
              {% endif %}
              {% if page.readtime %}
                {% include readtime.html %}
              {% endif %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    {% if page.cover-img %}<span class='img-desc'></span>{% endif %}
  </div>

  {% if page.header-extra %}
    {% for file in page.header-extra %}
      {% include {{ file }} %}
    {% endfor %}
  {% endif %}
</header>

<style>
/* 仅用于对齐样式的补充 */
.site-nav a {
  color: #333;
  font-weight: 500;
  transition: color 0.2s ease;
}
.site-nav a:hover {
  color: #0078ff;
  text-decoration: underline;
}
.site-title h1 {
  font-size: 1.5rem;
  color: #000;
  font-weight: 700;
  margin: 0;
}
</style>